# ==============================================================
# FastKAN Model Configuration
# ==============================================================

model:
  name: fastkan
  input_dim: 512                # kích thước đầu vào (phụ thuộc feature extractor)
  hidden_layers: [512, 256, 128, 64, 11]   # ví dụ: cho bài toán 11 lớp
  grid_min: -2.0
  grid_max: 2.0
  num_grids: 8
  use_base_update: true
  base_activation: silu
  spline_weight_init_scale: 0.1
  pretrained: false             # FastKAN không có pretrained weights
  freeze_backbone: false        # placeholder cho thống nhất cấu trúc

# --------------------------------------------------------------
# Training Hyperparameters
# --------------------------------------------------------------
training:
  epochs: 50
  batch_size: 32
  learning_rate: 0.001
  weight_decay: 1e-4
  optimizer: AdamW
  scheduler: cosine
  step_size: 10
  gamma: 0.1

# --------------------------------------------------------------
# Dataset and DataLoader
# --------------------------------------------------------------
data:
  train_dir: data/train
  val_dir: data/val
  test_dir: data/test
  num_workers: 4
  image_size: 224
  augmentation:
    horizontal_flip: true
    random_crop: true
    rotation: 10
    color_jitter: true

# --------------------------------------------------------------
# Logging and Checkpoint
# --------------------------------------------------------------
logging:
  log_dir: experiments/fastkan/logs
  save_dir: experiments/fastkan/checkpoints
  save_interval: 5
  print_interval: 50
  tensorboard: true

# --------------------------------------------------------------
# Device setup
# --------------------------------------------------------------
device:
  use_gpu: true
  gpu_id: 0
  mixed_precision: true
